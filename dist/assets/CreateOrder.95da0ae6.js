import{_ as V,m as q,D as z,s as o,h as F,M as j,P as E,v as Q,r as n,o as m,c as b,j as r,w as C,u as t,f as U,F as G,d as H,z as J,a as l,t as _,e as K,Q as W,R as S,S as w}from"./index.65ef0bc3.js";const X={class:"address-wrap"},Y={class:"name"},Z={class:"address"},$={__name:"CreateOrder",setup(ee){let c=q(),v=z(),p=o(""),g=o(""),I=o(""),u=o([]),h=o([]),y=o(v.query.addressId),i=o(""),d=o(!1),k=o([{name:"\u5FAE\u4FE1\u652F\u4ED8"},{name:"\u652F\u4ED8\u5B9D\u652F\u4ED8"}]);F(()=>{N(),x()});let N=async()=>{let e=await j(v.query.addressId);p.value=e.data.userName,g.value=e.data.userPhone,I.value=e.data.provinceName+e.data.cityName+e.data.regionName+e.data.detailAddress},x=()=>{E(localStorage.getItem("cartItemIds")).then(e=>{u.value=e.data})},O=Q(()=>u.value.reduce((e,a)=>e+a.goodsCount*a.sellingPrice*100,0)),L=()=>{h.value=localStorage.getItem("cartItemIds").split(","),d.value=!0,W({addressId:y.value,cartItemIds:[...h.value]}).then(e=>{i.value=e.data})},B=()=>{},P=e=>{e.name=="\u5FAE\u4FE1\u652F\u4ED8"?S(i.value,1).then(a=>{w({message:"\u652F\u4ED8\u6210\u529F",duration:500}),setTimeout(()=>{c.replace("/order")},500)}):e.name=="\u652F\u4ED8\u5B9D\u652F\u4ED8"&&S(i.value,2).then(a=>{w({message:"\u652F\u4ED8\u6210\u529F",duration:500}),setTimeout(()=>{c.replace("/order")},500)}),localStorage.removeItem("cartItemIds")};return(e,a)=>{const f=n("van-icon"),R=n("van-nav-bar"),T=n("router-link"),A=n("van-card"),D=n("van-submit-bar"),M=n("van-action-sheet");return m(),b("div",null,[r(R,{title:"\u751F\u6210\u8BA2\u5355","left-arrow":"",onClickLeft:a[0]||(a[0]=s=>t(c).back())},{right:C(()=>[r(f,{name:"ellipsis",size:"18"})]),_:1}),U(" --> "),r(T,{to:"/addressList"},{default:C(()=>[l("div",X,[l("div",Y,[l("span",null,_(t(p)),1),l("span",null,_(t(g)),1)]),r(f,{name:"arrow"}),l("div",Z,[l("span",null,_(t(I)),1)])])]),_:1}),(m(!0),b(G,null,H(t(u),s=>(m(),K(A,{key:s.cartItemId,num:s.goodsCount,price:s.sellingPrice,title:s.goodsName,thumb:s.goodsCoverImg},null,8,["num","price","title","thumb"]))),128)),r(D,{price:t(O),"button-text":"\u63D0\u4EA4\u8BA2\u5355","tip-icon":"info-o",onSubmit:t(L)},null,8,["price","onSubmit"]),r(M,{show:t(d),"onUpdate:show":a[1]||(a[1]=s=>J(d)?d.value=s:d=s),actions:t(k),"cancel-text":"\u53D6\u6D88",onSelect:t(P),onCancel:t(B),"close-on-click-action":""},null,8,["show","actions","onSelect","onCancel"])])}}},ae=V($,[["__scopeId","data-v-490ae3c0"]]);export{ae as default};
